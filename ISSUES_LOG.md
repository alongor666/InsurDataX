# 问题与解决日志

本文档用于记录在“车险经营分析周报”项目开发过程中遇到的主要问题及其解决方案。

## 日志格式
- **问题描述**: 清晰描述遇到的问题或错误。
- **发生时间**: 问题首次被注意到的时间。
- **影响范围**: 问题影响的功能模块或组件。
- **解决方案**: 简述解决该问题的步骤和方法。
- **状态**: (例如：已解决, 处理中, 待观察)
- **备注**: (可选) 其他相关信息。

---

## 记录

### 1. ReferenceError: ShieldAlert is not defined / selectedPeriodId is not defined
- **问题描述**: 
    - 应用在加载时因 `ShieldAlert is not defined` 报错，后续修复为 `selectedPeriodId is not defined`。
    - 根本原因是在数据处理层 (`src/lib/data-utils.ts` 的 `calculateKpis` 函数) 中直接引用了React组件或未正确传递/使用变量。
- **发生时间**: 2024-05-23 (根据对话记录估算)
- **影响范围**: KPI看板的数据加载和显示。
- **解决方案**: 
    1.  **图标问题**: 将 `Kpi.icon` 类型从直接存储组件改为存储图标的字符串名称，并在 `KpiCard` 组件中通过 `iconMap` 将字符串名称映射到实际的Lucide图标组件。
    2.  **变量未定义问题**: 确保 `calculateKpis` 函数通过参数接收其所需的所有依赖项 (如 `activePeriodId`)，并在函数内部正确使用这些参数，而不是依赖外部作用域或全局变量。
- **状态**: 已解决
- **备注**: 此问题强调了数据处理逻辑与UI展示逻辑分离的重要性。

---
